<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V6 WODPulse - Relatórios</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700;900&display=swap">
    <link rel="stylesheet" href="report.css">
    <!-- Dexie.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dexie/4.2.0/dexie.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- html2pdf.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>V6 WODPulse - Relatórios</h1>
            <div class="header-buttons">
                <button onclick="exportReportToPDF()">Exportar PDF</button>
                <button onclick="window.close()">Fechar</button>
            </div>
        </header>

        <!-- Filtros -->
        <section class="filter-section">
            <div class="filter-item">
                <label>Data da aula:</label>
                <input type="date" id="filter-date">
            </div>
            <div class="filter-item">
                <label>Tipo de aula:</label>
                <select id="filter-type">
                    <option value="todas">Todas</option>
                    <option value="automaticas">Apenas automáticas</option>
                    <option value="manuais">Apenas manuais</option>
                </select>
            </div>
            <div class="filter-item">
                <label>Aluno:</label>
                <select id="filter-aluno">
                    <option value="">Todos / Selecione</option>
                </select>
            </div>
            <button class="filter-btn" onclick="loadReport()">Filtrar</button>
        </section>

        <!-- Aulas encontradas -->
        <section id="aulas-section">
            <h2>Aulas Encontradas</h2>
            <div id="today-list"></div>
        </section>

        <!-- Rankings -->
        <section id="rankings-section">
            <h2>Rankings</h2>

            <div class="ranking-group">
                <h3>Geral - Pontos BPM (Top 5)</h3>
                <table id="geral-pontos-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Pontos</th><th>Gráfico HR</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="ranking-group">
                <h3>Geral - Calorias (Top 5)</h3>
                <table id="geral-calorias-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Calorias</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="ranking-group">
                <h3>Geral - VO2 Time (Top 5)</h3>
                <table id="geral-vo2-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Tempo VO2</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="ranking-group">
                <h3>Homens - Pontos BPM (Top 5)</h3>
                <table id="homens-pontos-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Pontos</th><th>Gráfico HR</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="ranking-group">
                <h3>Homens - Calorias (Top 5)</h3>
                <table id="homens-calorias-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Calorias</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="ranking-group">
                <h3>Homens - VO2 Time (Top 5)</h3>
                <table id="homens-vo2-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Tempo VO2</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="ranking-group">
                <h3>Mulheres - Pontos BPM (Top 5)</h3>
                <table id="mulheres-pontos-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Pontos</th><th>Gráfico HR</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="ranking-group">
                <h3>Mulheres - Calorias (Top 5)</h3>
                <table id="mulheres-calorias-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Calorias</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="ranking-group">
                <h3>Mulheres - VO2 Time (Top 5)</h3>
                <table id="mulheres-vo2-table">
                    <thead><tr><th>Pos</th><th>Nome</th><th>Tempo VO2</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <!-- Gráfico de FC -->
        <section id="grafico-section" class="hidden">
            <h2>Histórico de FC - <span id="grafico-nome"></span></h2>
            <div id="grafico-metricas"></div>
            <canvas id="hrChart" width="800" height="400"></canvas>
        </section>
    </div>

    <!-- Importação dos arquivos como módulos (type="module" permite await e imports) -->
    <script type="module">
        // Importa os arquivos na pasta reports
        import './reports/report-data.js';
        import './reports/report-ui.js';
        import './report.js';
    </script>
</body>
</html>